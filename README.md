# 📝 Products 페이지

상품 리스트, 상품 상세, 필터, 검색 기능이 포함된 상품 페이지

## 기술 스택

- TypeScript
- React
- Emotion
- React-Query
- Graphql
- apollo-server
- Cypress

## 추가 기능

- 그리드뷰 / 리스트뷰 전환 기능
- graphql apollo-server 구현
- 약간의 반응형
- e2e test

## 이슈 사항 및 해결

### 1. 첫 스크롤에 모든 데이터가 출력됨

스크롤 당 상품 데이터를 12개 씩 뿌려주는 것으로 무한 스크롤 구현하였는데, 페이지 첫 접근 시에는 12개가 잘 나타났으나, 다음 스크롤에서 12개가 아닌, **나머지 모든 데이터가 출력되는 오류**가 발생했습니다.

원인은 graphql 쿼리의 parameter 타입을 ID로 설정하고 이를 계산할 때 타입변환을 하지 않았기 때문이었습니다. `data.slice(args, args + 12)` 와 같이 전체 데이터에서 입력받은 args 위치부터 12개를 내보내도록 구현을 했었는데, 첫 번째에는 `'0' + 12 => '012' => 12`로 인식되어 잘 나왔었고, 두 번째 부터는 `'12' + 12 => '1212'` 로 인식되어 모든 데이터가 출력되었던 것이었습니다. args를 number로 인식하여 계산하도록 수정하여 해결하였습니다.

### 2. 필터 적용 취소 시 필터 모달을 연 후 부터 체크된 내용이 모달 열기 전으로 초기화 되어야 함

필터 모달을 열고 아이템을 선택하면 해당 아이템이 `checkedItems` 에 추가되며 적용 버튼을 누를 시, `checkedItems`의 내용이 url에 연동되는 로직으로 구현되어있습니다.

취소 기능을 구현하던 중, `setCheckedItemList`를 적용 버튼을 눌렀을 때 동작하거나, 모달을 연 후 체크된 내용을 관리하는 상태를 만드는 등의 방법을 생각했지만, 모두 추가적인 상태를 구현하는 방식이었고, 기존에 가진 정보들로 해결할 수는 없을까 고민했습니다.

filter내용이 url에 연동되어있으니 필터 적용 취소 시 url 데이터를 가져와 `checkedItemList` 초기화 해주는 것으로 해결했습니다.

## 프로젝트 설치 및 시작

### 서버 패키지 설치

```
$ cd server
$ yarn
```

### 서버 실행

```
$ yarn start
```

### 서버 환경

```
http://localhost/8000/graphql
```

### 클라이언트 패키지 설치

```
$ cd ../client  ( client 폴더 이동 )
$ yarn
```

### 클라이언트 실행

```
$ yarn start
```

### 클라이언트 환경

```
http://localhost/3000
```

### 테스트 실행

```
$ yarn cypress run
or
$ yarn cypress open
```
